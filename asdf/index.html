#!/usr/bin/env bash
cat >/dev/null <<'# djeeno.github.io'
<link rel="icon" href="/favicon.ico" type="image/x-icon"><style>body{font-size:0;margin:0}code{font-size:1rem;font-family:'Ricty Diminished',Osaka,Menlo,Monaco,Consolas,'Courier New','Andale Mono','Ubuntu Mono',monospace}</style><pre><code>##
# djeeno.github.io
##

export HTTP_CLIENT; HTTP_CLIENT="$( { command -v curl 1>/dev/null && printf "curl -LSs "; } || { command -v wget 1>/dev/null && printf "wget -qO- "; } )"
[ "${HTTP_CLIENT:?"curl or wget are required to run this script"}" ] || exit 1

# shellcheck disable=SC2154
[ "${envIsLoaded}" = true ] || eval "$(${HTTP_CLIENT} https://djeeno.github.io/common/)" || exit 1

asdf_version=${ASDF_VERSION:=v0.7.4}
echo "env:" | stderrNotice
echo "  ASDF_VERSION=${ASDF_VERSION:-USE_DEFAULT}" | stderrNotice

echo "Install asdf to \"~/.asdf\"" | stderrNotice
test -d ~/.asdf || git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch "${asdf_version}" | stderrInfo

echo "Append codes for asdf to \"~/.bashrc\"" | stderrNotice
# shellcheck disable=SC2016,SC2088
grep -q '~/.asdf/' ~/.bashrc || printf '\n%s\n%s\n%s\n' '# asdf' 'test ! -f ~/.asdf/asdf.sh || . "$_"' 'test ! -f ~/.asdf/completions/asdf.bash || . "$_"' | tee -a ~/.bashrc | stderrNotice
# shellcheck disable=SC1090
. ~/.asdf/asdf.sh | stderrInfo
# shellcheck disable=SC1090
. ~/.asdf/completions/asdf.bash | stderrInfo

echo "Update asdf" | stderrNotice
asdf update | stderrInfo

echo "Update asdf plugins" | stderrNotice
asdf plugin-update --all | stderrInfo

echo "Show asdf plugins current versions" | stderrNotice
asdf current | stderrInfo

echo "正常にインストールされました。" | stderrOK

# (C) 2018 djeeno </code></pre></div>
